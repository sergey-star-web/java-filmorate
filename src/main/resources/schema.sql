DROP TABLE IF EXISTS genres CASCADE;
CREATE TABLE IF NOT EXISTS genres
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name TEXT NOT NULL
);

DROP TABLE IF EXISTS mpa_rating CASCADE;
CREATE TABLE IF NOT EXISTS mpa_rating
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name TEXT NOT NULL,
    description TEXT
);

DROP TABLE IF EXISTS films CASCADE;
CREATE TABLE IF NOT EXISTS films
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name TEXT NOT NULL,
    description TEXT(200),
    releaseDate DATETIME,
    duration INTEGER,
    mpa_rating_id INTEGER REFERENCES mpa_rating (id) NOT NULL
);

DROP TABLE IF EXISTS genres_in_film CASCADE;
CREATE TABLE IF NOT EXISTS genres_in_film
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    film_id INTEGER REFERENCES films (id) NOT NULL,
    genre_id INTEGER REFERENCES genres (id) NOT NULL
);

DROP TABLE IF EXISTS users CASCADE;
CREATE TABLE IF NOT EXISTS users
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email TEXT NOT NULL,
    login TEXT,
    name TEXT,
    birthday DATE
);

DROP TABLE IF EXISTS friends CASCADE;
CREATE TABLE IF NOT EXISTS friends
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_send_id INTEGER REFERENCES users (id) NOT NULL,
    user_received_id INTEGER REFERENCES users (id) NOT NULL,
    confirm_friendship_status BOOLEAN NOT NULL
);

DROP TABLE IF EXISTS likes CASCADE;
CREATE TABLE IF NOT EXISTS likes
(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id INTEGER REFERENCES users (id) NOT NULL,
    film_id INTEGER REFERENCES films (id) NOT NULL
);
